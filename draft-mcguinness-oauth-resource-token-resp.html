<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 Resource Parameter in Access Token Response</title>
<meta content="Karl McGuinness" name="author">
<meta content="Jared Hanson" name="author">
<meta content="
       This specification defines a new parameter  resource  to be returned in OAuth 2.0 access token responses. It enables clients to confirm that the issued token is valid for to the intended resource. This mitigates ambiguity and certain classes of security vulnerabilities such as resource mix-up attacks, particularly in systems that use the Resource Indicators for OAuth 2.0 specification  . 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="OAuth 2.0" name="keyword">
<meta content="Resource Indicators" name="keyword">
<meta content="Authorization Server" name="keyword">
<meta content="Token Response" name="keyword">
<meta content="Mix-up Attack" name="keyword">
<meta content="draft-mcguinness-oauth-resource-token-resp-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-mcguinness-oauth-resource-token-resp.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Resource Token Response Parameter</td>
<td class="right">December 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">McGuinness &amp; Hanson</td>
<td class="center">Expires 24 June 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mcguinness-oauth-resource-token-resp-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-12-21" class="published">21 December 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-06-24">24 June 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. McGuinness</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">J. Hanson</div>
<div class="org">Keycard Labs</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 Resource Parameter in Access Token Response</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines a new parameter <code>resource</code> to be returned in OAuth 2.0 access token responses. It enables clients to confirm that the issued token is valid for to the intended resource. This mitigates ambiguity and certain classes of security vulnerabilities such as resource mix-up attacks, particularly in systems that use the Resource Indicators for OAuth 2.0 specification <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://mcguinness.github.io/draft-mcguinness-oauth-resource-token-resp/draft-mcguinness-oauth-resource-token-resp.html">https://mcguinness.github.io/draft-mcguinness-oauth-resource-token-resp/draft-mcguinness-oauth-resource-token-resp.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-mcguinness-oauth-resource-token-resp/">https://datatracker.ietf.org/doc/draft-mcguinness-oauth-resource-token-resp/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Web Authorization Protocol Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/mcguinness/draft-mcguinness-resource-token-resp">https://github.com/mcguinness/draft-mcguinness-resource-token-resp</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 June 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-resource-mix-up-via-dynamic" class="internal xref">Resource Mix-Up via Dynamic Discovery Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-resource-vs-audience" class="internal xref">Resource vs Audience</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-resource-parameter-in-token" class="internal xref">Resource Parameter in Token Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-authorization-server-proces" class="internal xref">Authorization Server Processing Rules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-client-processing-rules" class="internal xref">Client Processing Rules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-overview-2" class="internal xref">Overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-summary-table-2" class="internal xref">Summary Table</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-parsing-the-resource-parame" class="internal xref">Parsing the <code>resource</code> Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="auto internal xref">3.2.4</a>.  <a href="#name-resource-identifier-comparis" class="internal xref">Resource Identifier Comparison</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="auto internal xref">3.2.5</a>.  <a href="#name-client-requested-exactly-on" class="internal xref">Client Requested Exactly One Resource</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#section-3.2.6" class="auto internal xref">3.2.6</a>.  <a href="#name-client-requested-multiple-r" class="internal xref">Client Requested Multiple Resources</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a href="#section-3.2.7" class="auto internal xref">3.2.7</a>.  <a href="#name-client-did-not-request-a-res" class="internal xref">Client Did Not Request a Resource</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.8">
                    <p id="section-toc.1-1.3.2.2.2.8.1"><a href="#section-3.2.8" class="auto internal xref">3.2.8</a>.  <a href="#name-invalid-resource" class="internal xref">Invalid Resource</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-oauth-access-token-response" class="internal xref">OAuth Access Token Response Parameters Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-additional-examples" class="internal xref">Additional Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-requesting-a-token-for-a-dy" class="internal xref">Requesting a token for a dynamically discovered protected resource</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OAuth 2.0 defines a framework in which clients obtain access tokens from authorization servers and present them to protected resources. In deployments involving multiple protected resources or resource servers (APIs), clients often need to determine whether a given access token is valid for a specific resource.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The Resource Indicators for OAuth 2.0 specification <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> introduced the <code>resource</code> request parameter, which allows a client to indicate the protected resource or resources for which an access token is intended to be used. An authorization server can use this information when issuing an access token, for example by applying resource-specific restrictions based on policy or configuration.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">However, <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> does not define any mechanism for an authorization server to confirm, in the access token response, which resource or resources were ultimately accepted. As a result, a client has no interoperable way to validate the effective resource scope of an issued access token.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">When an authorization request includes one or more <code>resource</code> parameters, authorization servers in deployed systems may exhibit a range of behaviors depending on their capabilities and policy configuration. An authorization server <span class="bcp14">MAY</span>, for example:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1">Ignore the <code>resource</code> parameter and issue an access token that is not restricted to any specific resource.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1">Ignore the <code>resource</code> parameter and issue an access token that is valid for a default resource or set of resources.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1">Accept all requested <code>resource</code> values and issue an access token that is valid for the complete requested set.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.4">
          <p id="section-1-5.4.1">Accept only a subset of requested <code>resource</code> values and issue an access token that is valid for that subset, without explicitly indicating that other requested resources were rejected.<a href="#section-1-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.5">
          <p id="section-1-5.5.1">Override the requested <code>resource</code> values and issue an access token that is valid for resources determined by authorization server policy or client configuration.<a href="#section-1-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.6">
          <p id="section-1-5.6.1">Reject the request by returning an <code>invalid_target</code> error response as defined in <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>.<a href="#section-1-5.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-6">In the absence of explicit confirmation in the token response, a client cannot determine which of these behaviors occurred and may incorrectly assume that an access token is valid for a particular resource.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This ambiguity is especially problematic in deployments that rely on dynamic discovery of protected resources and authorization servers. In such environments, a client may learn the protected resource URL at runtime and discover an authorization server using OAuth 2.0 Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>, without any pre-established trust relationship between the client and the resource. See <a href="#resource-mix-up-via-dynamic-discovery-example" class="auto internal xref">Section 1.1</a> for an example of how this can lead to resource mix-up attacks.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">A key challenge in these deployments is that the client has no reliable way to validate whether a discovered authorization server is actually authoritative for a given protected resource. While <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> allows protected resource metadata to be cryptographically signed, this would require clients to be pre-configured with trust anchors for signature verification, which defeats the purpose of runtime discovery.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">Similarly, an authorization server could publish a list of protected resources it supports in its metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>, but this approach does not scale in practice for large APIs or resource domains with many distinct resource identifiers, nor does it address cases where authorization server policy dynamically determines resource validity.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">Some clients attempt to infer the applicability of an access token by examining its audience information. If supported by the authorization server, a client <span class="bcp14">MAY</span> use token introspection <span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span> to learn an issued token's audience value, or may inspect the <code>aud</code> claim when using self-contained token formats such as JWTs <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> that are not encrypted. However, access tokens are intended to be opaque to the client, as specified in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-1.4" class="relref">Section 1.4</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. Audience values are token-format-specific and are commonly used to represent authorization servers, tenants, resource servers, or other logical identifiers rather than concrete protected resource URLs. A resource server protecting a given resource may accept tokens with broad, narrow, or indirect audience values that do not have a predictable or discoverable relationship to the resource's URL.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">As a result, learning the audience of an issued access token does not provide a reliable or interoperable way for a client to determine whether the token is valid for the intended resource, particularly when multiple protected resources share an authorization server or when the client interacts with resources discovered dynamically at runtime. This document uses the term <em>resource</em> as defined in <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>. The relationship between resources and token audience values is discussed further in <a href="#resource-vs-audience" class="auto internal xref">Section 2.1.1</a>.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">Consequently, existing OAuth mechanisms do not provide a practical, interoperable way for a client to confirm that an issued access token is valid for the intended resource.<a href="#section-1-12" class="pilcrow">¶</a></p>
<p id="section-1-13">This specification defines a new <code>resource</code> parameter to be returned in OAuth 2.0 access token responses. The parameter explicitly identifies the protected resource or resources for which the issued access token is valid, enabling clients to validate token applicability before use and reducing ambiguity across deployments.<a href="#section-1-13" class="pilcrow">¶</a></p>
<div id="resource-mix-up-via-dynamic-discovery-example">
<section id="section-1.1">
        <h3 id="name-resource-mix-up-via-dynamic">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-resource-mix-up-via-dynamic" class="section-name selfRef">Resource Mix-Up via Dynamic Discovery Example</a>
        </h3>
<p id="section-1.1-1">The following example illustrates how ambiguity about the effective resource scope of an issued access token can lead to a resource mix-up attack in deployments that rely on dynamic discovery.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2"><strong>Preconditions:</strong><a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">A client wants to access a protected resource at <code>https://api.example.net/data</code> and is not statically configured with knowledge of that resource or its authorization server.<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">The client uses OAuth 2.0 Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> to dynamically discover an authorization server for the resource.<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.3">
            <p id="section-1.1-3.3.1">An attacker controls the protected resource at <code>https://api.example.net/data</code> and publishes Protected Resource Metadata claiming <code>https://legit-as.example.com</code> as the authorization server, advertising legitimate-looking scopes such as <code>data:read data:write</code>.<a href="#section-1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.4">
            <p id="section-1.1-3.4.1">The client has an existing client registration with <code>https://legit-as.example.com</code>.<a href="#section-1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.5">
            <p id="section-1.1-3.5.1">The authorization server at <code>https://legit-as.example.com</code> does not support <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> and ignores the <code>resource</code> parameter, issuing access tokens based solely on requested scopes.<a href="#section-1.1-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.6">
            <p id="section-1.1-3.6.1">The user trusts <code>https://legit-as.example.com</code> and would consent to the requested scopes for a legitimate client.<a href="#section-1.1-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-4"><strong>Attack Flow:</strong><a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-5">
<li id="section-1.1-5.1">
            <p id="section-1.1-5.1.1">The client retrieves Protected Resource Metadata from <code>https://api.example.net/data</code> and discovers <code>https://legit-as.example.com</code> as the authorization server.<a href="#section-1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-5.2">
            <p id="section-1.1-5.2.1">The client sends an authorization request to <code>https://legit-as.example.com</code>, including <code>resource=https://api.example.net/data</code> and scopes <code>data:read data:write</code>.<a href="#section-1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-5.3">
            <p id="section-1.1-5.3.1">The authorization server processes the request based on scopes, ignores the <code>resource</code> parameter, and—after user consent—issues an access token without confirming the selected resource.<a href="#section-1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-5.4">
            <p id="section-1.1-5.4.1">The client receives the access token but cannot determine whether it is valid for <code>https://api.example.net/data</code> or for some other protected resource.<a href="#section-1.1-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-5.5">
            <p id="section-1.1-5.5.1">The client presents the access token to <code>https://api.example.net/data</code>. The attacker intercepts the token and reuses it to access a legitimate protected resource that trusts the same authorization server and accepts tokens with the same scopes.<a href="#section-1.1-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.1-6">Without explicit confirmation of the resource in the token response, the client cannot detect that the authorization server ignored or overrode the requested resource indicator. User consent alone may not prevent this attack, particularly when authorization servers do not prominently display resource information during authorization.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-2.1">
        <h3 id="name-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">The terms "client", "authorization server", "resource server', "access token", "protected resource", "authorization request", "authorization response", "access token request", "access token response" are defined by the OAuth 2.0 Authorization Framework specification <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The term "resource" is defined by the Resource Indicators for OAuth 2.0 specification <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">The term "StringOrURI" is defined by the JWT specification <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<div id="resource-vs-audience">
<section id="section-2.1.1">
          <h4 id="name-resource-vs-audience">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-resource-vs-audience" class="section-name selfRef">Resource vs Audience</a>
          </h4>
<p id="section-2.1.1-1">This specification uses the term <strong>resource</strong> (as defined in <span><a href="https://rfc-editor.org/rfc/rfc8707#section-2" class="relref">Section 2</a> of [<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> and <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>) rather than <strong>audience</strong> (as used in access token claims such as the <code>aud</code> claim in JWTs <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> or in token introspection <span><a href="https://rfc-editor.org/rfc/rfc7662#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>) because a client cannot assume a fixed or discoverable relationship between a protected resource URL and an access token’s audience value.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">Audience values are token-format-specific and are commonly used to represent authorization servers, tenants, resource servers, or logical identifiers rather than concrete protected resource URLs. As a result, a client cannot rely on audience claims alone to determine where an access token is valid for use, particularly when tokens are opaque or when multiple protected resources share an authorization server.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.1-3">While a resource identifier and an access token’s audience value may coincide in some deployments, they are not equivalent. A resource server protecting a given resource may accept access tokens with audience restrictions that are:<a href="#section-2.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1-4.1">
              <p id="section-2.1.1-4.1.1"><strong>Broad</strong>, such as <code>https://api.example.com</code>, representing an API-wide identifier.<a href="#section-2.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.1-4.2">
              <p id="section-2.1.1-4.2.1"><strong>Narrow</strong>, such as <code>https://api.example.com/some/protected/resource</code>, representing a specific protected resource.<a href="#section-2.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.1-4.3">
              <p id="section-2.1.1-4.3.1"><strong>Logical or indirect</strong>, such as <code>urn:example:api</code> or <code>https://example.net</code>, which have no direct correspondence to the resource’s URL.<a href="#section-2.1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.1.1-5">Because audience assignment is a matter of authorization server policy, a client cannot reliably predict which audience value will be used in an issued access token or which audience values a resource server will accept. This limitation is particularly relevant in dynamic environments, such as when using OAuth 2.0 Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>, where a client can discover the protected resource URL but not the authorization server’s audience assignment policy.<a href="#section-2.1.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1.1-6">For these reasons, returning audience information in the token response is less useful to a client than returning the resource or resources for which the access token was issued. By returning the <code>resource</code> parameter, this specification enables a client to:<a href="#section-2.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1-7.1">
              <p id="section-2.1.1-7.1.1">Confirm that the access token is valid for the specific resource it requested.<a href="#section-2.1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.1-7.2">
              <p id="section-2.1.1-7.2.1">Detect resource mix-up conditions in which an authorization server issues a token for a different resource than intended.<a href="#section-2.1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.1.1-8">This approach is consistent with Resource Indicators <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> and Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>, which define the <code>resource</code> parameter as the client-facing mechanism for identifying the target protected resource, independent of how a resource server enforces audience restrictions internally.<a href="#section-2.1.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1.1-9"><strong>Non-Goal:</strong> This specification does not define, constrain, or replace the use of audience values in access tokens, nor does it require any particular token format. How authorization servers encode audience information and how resource servers enforce audience restrictions are explicitly out of scope.<a href="#section-2.1.1-9" class="pilcrow">¶</a></p>
<p id="section-2.1.1-10">If supported by the authorization server, a client <span class="bcp14">MAY</span> use token introspection <span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span> to obtain audience information for an issued access token when such information is required.<a href="#section-2.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="resource-parameter-in-token-response">
<section id="section-3">
      <h2 id="name-resource-parameter-in-token">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-resource-parameter-in-token" class="section-name selfRef">Resource Parameter in Token Response</a>
      </h2>
<p id="section-3-1">Authorization servers that support this specification <span class="bcp14">SHOULD</span> include the <code>resource</code> parameter in successful access token responses, as defined in Section 5.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, to identify a protected resource for which the access token is valid.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The value of the <code>resource</code> parameter <span class="bcp14">MUST</span> be either:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
          <p id="section-3-3.1.1">A single case-sensitive string containing an absolute URI value, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8707#section-2" class="relref">Section 2</a> of [<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>, when the access token is valid for exactly one resource.<a href="#section-3-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.2">
          <p id="section-3-3.2.1">An array of case-sensitive strings, each containing an absolute URI value, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8707#section-2" class="relref">Section 2</a> of [<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>, when the access token is valid for multiple resources.  The array <span class="bcp14">MUST</span> contain at least one element, and each element <span class="bcp14">MUST</span> be unique within the array.<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-4">The <code>resource</code> parameter uses the same value syntax and requirements as the <code>resource</code> request parameter defined in <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>. In particular, each value <span class="bcp14">MUST</span> be an absolute URI, <span class="bcp14">MUST NOT</span> contain a fragment component, and <span class="bcp14">SHOULD NOT</span> contain a query component.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-5">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "2YotnFZFEjr1zCsicMWpAA",
  "token_type": "Bearer",
  "expires_in": 3600,
  "resource": "https://api.example.com/"
}
</pre><a href="#section-3-5" class="pilcrow">¶</a>
</div>
<div id="authorization-server-processing-rules">
<section id="section-3.1">
        <h3 id="name-authorization-server-proces">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authorization-server-proces" class="section-name selfRef">Authorization Server Processing Rules</a>
        </h3>
<p id="section-3.1-1">An authorization server that supports this specification <span class="bcp14">MUST</span> decide whether and how to include the <code>resource</code> parameter in a successful access token response (see <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, Section 5.1) according to the rules in this section.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="overview">
<section id="section-3.1.1">
          <h4 id="name-overview">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
          </h4>
<p id="section-3.1.1-1">Authorization server processing is driven by the number of <code>resource</code> parameters included in the authorization request or token request (see <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>). The rules below are mutually exclusive and depend on whether the client requested zero, exactly one, or more than one resource.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">These authorization server processing rules apply equally to access tokens issued using the authorization code grant and to access tokens issued using a refresh token grant.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">Access tokens issued under these rules are valid for the resource(s) identified in the response.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<div id="summary-table">
<section id="section-3.1.1.1">
            <h5 id="name-summary-table">
<a href="#section-3.1.1.1" class="section-number selfRef">3.1.1.1. </a><a href="#name-summary-table" class="section-name selfRef">Summary Table</a>
            </h5>
<table class="center" id="table-1">
              <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Client Request Shape</th>
                  <th class="text-left" rowspan="1" colspan="1">Authorization Server Outcome</th>
                  <th class="text-left" rowspan="1" colspan="1">Authorization Server Processing Rules</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Exactly one <code>resource</code> requested</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">No acceptable resource</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> return <code>invalid_target</code> and <span class="bcp14">MUST NOT</span> issue an access token.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">One acceptable resource</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> issue an access token and <span class="bcp14">MUST</span> include <code>resource</code> as a string containing the accepted resource.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Multiple <code>resource</code> values requested</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">No acceptable resources</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> return <code>invalid_target</code> and <span class="bcp14">MUST NOT</span> issue an access token.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">Subset of requested resources acceptable</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> issue an access token and <span class="bcp14">MUST</span> include <code>resource</code> as an array containing only the accepted subset.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">All requested resources acceptable</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> issue an access token and <span class="bcp14">MUST</span> include <code>resource</code> as an array containing all accepted resources.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>No <code>resource</code> requested</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">Default resource(s) assigned</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">SHOULD</span> issue an access token and <span class="bcp14">SHOULD</span> include the assigned resource(s) in the <code>resource</code> parameter.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">No resource-specific restriction</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">SHOULD</span> issue an access token and <span class="bcp14">SHOULD</span> omit the <code>resource</code> parameter.</td>
                </tr>
              </tbody>
            </table>
</section>
</div>
<div id="resource-identifier-comparison">
<section id="section-3.1.1.2">
            <h5 id="name-resource-identifier-compari">
<a href="#section-3.1.1.2" class="section-number selfRef">3.1.1.2. </a><a href="#name-resource-identifier-compari" class="section-name selfRef">Resource Identifier Comparison</a>
            </h5>
<p id="section-3.1.1.2-1">When comparing resource identifiers (for example, to determine uniqueness or to evaluate requested resources against policy), the authorization server <span class="bcp14">MUST</span> apply the URI comparison rules defined in <span><a href="https://rfc-editor.org/rfc/rfc3986#section-6.2.1" class="relref">Section 6.2.1</a> of [<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>, after applying syntax-based normalization as defined in <span><a href="https://rfc-editor.org/rfc/rfc3986#section-6.2.2" class="relref">Section 6.2.2</a> of [<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>. Resource identifiers that are equivalent under these rules <span class="bcp14">MUST</span> be treated as identical.<a href="#section-3.1.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-requested-one-or-more-resources">
<section id="section-3.1.1.3">
            <h5 id="name-client-requested-one-or-mor">
<a href="#section-3.1.1.3" class="section-number selfRef">3.1.1.3. </a><a href="#name-client-requested-one-or-mor" class="section-name selfRef">Client Requested One or More Resources</a>
            </h5>
<p id="section-3.1.1.3-1">If the client included one or more <code>resource</code> parameters in the authorization request or token request:<a href="#section-3.1.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1.3-2.1">
                <p id="section-3.1.1.3-2.1.1">The authorization server <span class="bcp14">MUST</span> evaluate the requested resource set according to local policy and determine the accepted resource set.<a href="#section-3.1.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.1.3-2.2">
                <p id="section-3.1.1.3-2.2.1">If the accepted resource set is empty, the authorization server <span class="bcp14">MUST</span> return an <code>invalid_target</code> error response as defined in <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span> and <span class="bcp14">MUST NOT</span> issue an access token.<a href="#section-3.1.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.1.3-2.3">
                <p id="section-3.1.1.3-2.3.1">If the accepted resource set is non-empty:<a href="#section-3.1.1.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1.3-2.3.2.1">
                    <p id="section-3.1.1.3-2.3.2.1.1">The authorization server <span class="bcp14">MUST</span> include the <code>resource</code> parameter in the access token response.<a href="#section-3.1.1.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.1.3-2.3.2.2">
                    <p id="section-3.1.1.3-2.3.2.2.1">The resource values in the response <span class="bcp14">MUST</span> be limited to the accepted resource set and <span class="bcp14">MUST NOT</span> include any resource value that was not requested by the client.<a href="#section-3.1.1.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.1.3-2.3.2.3">
                    <p id="section-3.1.1.3-2.3.2.3.1">The authorization server <span class="bcp14">MUST</span> ensure that the returned resource set contains no duplicate resource identifiers (including identifiers that differ only by URI normalization).<a href="#section-3.1.1.3-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.1.3-2.3.2.4">
                    <p id="section-3.1.1.3-2.3.2.4.1">If the accepted resource set contains exactly one resource, the <code>resource</code> parameter value <span class="bcp14">MUST</span> be a string containing that single resource identifier.<a href="#section-3.1.1.3-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.1.3-2.3.2.5">
                    <p id="section-3.1.1.3-2.3.2.5.1">If the accepted resource set contains more than one resource, the <code>resource</code> parameter value <span class="bcp14">MUST</span> be an array of strings containing those resource identifiers.<a href="#section-3.1.1.3-2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</section>
</div>
<div id="client-did-not-request-a-resource">
<section id="section-3.1.1.4">
            <h5 id="name-client-did-not-request-a-re">
<a href="#section-3.1.1.4" class="section-number selfRef">3.1.1.4. </a><a href="#name-client-did-not-request-a-re" class="section-name selfRef">Client Did Not Request a Resource</a>
            </h5>
<p id="section-3.1.1.4-1">If the client did not include any <code>resource</code> parameters in the authorization request or token request:<a href="#section-3.1.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1.4-2.1">
                <p id="section-3.1.1.4-2.1.1">If the authorization server assigns one or more default resources based on policy or client configuration, it <span class="bcp14">SHOULD</span> include the assigned resource(s) in the <code>resource</code> parameter of the response.<a href="#section-3.1.1.4-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.1.4-2.2">
                <p id="section-3.1.1.4-2.2.1">If the access token is not valid for any specific resource (for example, when the access token has no resource-specific restriction), the <code>resource</code> parameter <span class="bcp14">SHOULD</span> be omitted from the response.<a href="#section-3.1.1.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="client-processing-rules">
<section id="section-3.2">
        <h3 id="name-client-processing-rules">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-processing-rules" class="section-name selfRef">Client Processing Rules</a>
        </h3>
<p id="section-3.2-1">A client that supports this extension <span class="bcp14">MUST</span> process the access token response according to the rules in this section.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="overview-1">
<section id="section-3.2.1">
          <h4 id="name-overview-2">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-overview-2" class="section-name selfRef">Overview</a>
          </h4>
<p id="section-3.2.1-1">Client processing is driven by the number of <code>resource</code> parameters included in the authorization request or token request (see <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>). The rules below are mutually exclusive and depend on whether the client requested zero, exactly one, or more than one resource.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">If client validation succeeds, the client <span class="bcp14">MAY</span> use the access token and <span class="bcp14">MUST</span> use it only with the resource(s) identified in the response. If client validation fails at any point while applying these rules, the client <span class="bcp14">MUST NOT</span> use the access token and <span class="bcp14">SHOULD</span> discard it.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3">These client processing rules apply equally to access tokens issued using the authorization code grant and to access tokens issued using a refresh token grant.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary-table-1">
<section id="section-3.2.2">
          <h4 id="name-summary-table-2">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-summary-table-2" class="section-name selfRef">Summary Table</a>
          </h4>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Client Request Shape</th>
                <th class="text-left" rowspan="1" colspan="1">Token Response</th>
                <th class="text-left" rowspan="1" colspan="1">Client Processing Rules</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Exactly one <code>resource</code> requested</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> omitted</td>
                <td class="text-left" rowspan="1" colspan="1">Invalid. Client <span class="bcp14">MUST NOT</span> use the access token and <span class="bcp14">SHOULD</span> discard it.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> = string</td>
                <td class="text-left" rowspan="1" colspan="1">Valid only if the value matches the requested resource.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> = array (1 element)</td>
                <td class="text-left" rowspan="1" colspan="1">Valid only if the element matches the requested resource.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> = array (&gt;1 elements)</td>
                <td class="text-left" rowspan="1" colspan="1">Invalid. Client <span class="bcp14">MUST NOT</span> use the access token and <span class="bcp14">SHOULD</span> discard it.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Multiple <code>resource</code> values requested</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> omitted</td>
                <td class="text-left" rowspan="1" colspan="1">Invalid. Client <span class="bcp14">MUST NOT</span> use the access token and <span class="bcp14">SHOULD</span> discard it.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> = string</td>
                <td class="text-left" rowspan="1" colspan="1">Invalid. Client <span class="bcp14">MUST NOT</span> use the access token and <span class="bcp14">SHOULD</span> discard it.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> = array (subset of requested)</td>
                <td class="text-left" rowspan="1" colspan="1">Valid. Token is valid only for the returned subset.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> = array (exact match)</td>
                <td class="text-left" rowspan="1" colspan="1">Valid. Token is valid for all returned resources.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> = array (includes unrequested value)</td>
                <td class="text-left" rowspan="1" colspan="1">Invalid. Client <span class="bcp14">MUST NOT</span> use the access token and <span class="bcp14">SHOULD</span> discard it.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>No <code>resource</code> requested</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> omitted</td>
                <td class="text-left" rowspan="1" colspan="1">Valid. Token is not resource-specific.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> </td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>resource</code> present</td>
                <td class="text-left" rowspan="1" colspan="1">Valid. Client <span class="bcp14">MAY</span> treat the returned value as a default resource assignment.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Any request shape</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>error=invalid_target</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Client <span class="bcp14">MUST</span> treat this as a terminal error and <span class="bcp14">MUST NOT</span> use an access token.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="parsing-the-resource-parameter">
<section id="section-3.2.3">
          <h4 id="name-parsing-the-resource-parame">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-parsing-the-resource-parame" class="section-name selfRef">Parsing the <code>resource</code> Parameter</a>
          </h4>
<p id="section-3.2.3-1">If the access token response includes a <code>resource</code> parameter, the client <span class="bcp14">MUST</span> parse it as follows:<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.3-2.1">
              <p id="section-3.2.3-2.1.1">A string value represents a single resource identifier.<a href="#section-3.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.3-2.2">
              <p id="section-3.2.3-2.2.1">An array value represents multiple resource identifiers; each element <span class="bcp14">MUST</span> be a string.<a href="#section-3.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.3-2.3">
              <p id="section-3.2.3-2.3.1">Any other value is invalid; the client <span class="bcp14">MUST NOT</span> use the access token and <span class="bcp14">SHOULD</span> discard it.<a href="#section-3.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="resource-identifier-comparison-1">
<section id="section-3.2.4">
          <h4 id="name-resource-identifier-comparis">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-resource-identifier-comparis" class="section-name selfRef">Resource Identifier Comparison</a>
          </h4>
<p id="section-3.2.4-1">Resource identifiers <span class="bcp14">MUST</span> be compared using the URI comparison rules defined in <span><a href="https://rfc-editor.org/rfc/rfc3986#section-6.2.1" class="relref">Section 6.2.1</a> of [<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>, after applying syntax-based normalization as defined in <span><a href="https://rfc-editor.org/rfc/rfc3986#section-6.2.2" class="relref">Section 6.2.2</a> of [<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>. Resource identifiers that are equivalent under these rules <span class="bcp14">MUST</span> be treated as identical.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-requested-exactly-one-resource">
<section id="section-3.2.5">
          <h4 id="name-client-requested-exactly-on">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-client-requested-exactly-on" class="section-name selfRef">Client Requested Exactly One Resource</a>
          </h4>
<p id="section-3.2.5-1">If the client included exactly one <code>resource</code> parameter in the token request:<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.5-2.1">
              <p id="section-3.2.5-2.1.1">The response <span class="bcp14">MUST</span> contain exactly one matching resource identifier.<a href="#section-3.2.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.5-2.2">
              <p id="section-3.2.5-2.2.1">The returned resource identifier <span class="bcp14">MUST</span> match the requested resource.<a href="#section-3.2.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.5-2.3">
              <p id="section-3.2.5-2.3.1">If the response omits the <code>resource</code> parameter or contains zero or more than one resource identifier, validation fails.<a href="#section-3.2.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="ex-single-resource-authz">
<section id="section-3.2.5.1">
            <h5 id="name-authorization-request-examp">
<a href="#section-3.2.5.1" class="section-number selfRef">3.2.5.1. </a><a href="#name-authorization-request-examp" class="section-name selfRef">Authorization Request Example</a>
            </h5>
<p id="section-3.2.5.1-1">Client obtains an access token for the Customers protected resource (<code>https://api.example.com/customers</code>) using the authorization code grant.<a href="#section-3.2.5.1-1" class="pilcrow">¶</a></p>
<div id="authorization-request">
<section id="section-3.2.5.1.1">
              <h6 id="name-authorization-request">
<a href="#section-3.2.5.1.1" class="section-number selfRef">3.2.5.1.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
              </h6>
<p id="section-3.2.5.1.1-1">Client makes an authorization request for the Customers protected resource (<code>https://api.example.com/customers</code>).<a href="#section-3.2.5.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.5.1.1-2">
<pre>
GET /authorize?response_type=code
  &amp;client_id=client123
  &amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
  &amp;scope=customers%3Aread
  &amp;state=abc123
  &amp;resource=https%3A%2F%2Fapi.example.com%2Fcustomers
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
HTTP/1.1
Host: authorization-server.example.com
</pre><a href="#section-3.2.5.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="redirect">
<section id="section-3.2.5.1.2">
              <h6 id="name-redirect">
<a href="#section-3.2.5.1.2" class="section-number selfRef">3.2.5.1.2. </a><a href="#name-redirect" class="section-name selfRef">Redirect</a>
              </h6>
<p id="section-3.2.5.1.2-1">The authorization server redirects the user-agent back to the client with an authorization code.<a href="#section-3.2.5.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.5.1.2-2">
<pre>
HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA&amp;state=abc123
</pre><a href="#section-3.2.5.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-request">
<section id="section-3.2.5.1.3">
              <h6 id="name-token-request">
<a href="#section-3.2.5.1.3" class="section-number selfRef">3.2.5.1.3. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
              </h6>
<p id="section-3.2.5.1.3-1">The client exchanges the authorization code for an access token.<a href="#section-3.2.5.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.5.1.3-2">
<pre>
POST /token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=SplxlOBeZQQYbYS6WxSbIA&amp;
redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb&amp;
client_id=client123&amp;
code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
</pre><a href="#section-3.2.5.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-response">
<section id="section-3.2.5.1.4">
              <h6 id="name-token-response">
<a href="#section-3.2.5.1.4" class="section-number selfRef">3.2.5.1.4. </a><a href="#name-token-response" class="section-name selfRef">Token Response</a>
              </h6>
<p id="section-3.2.5.1.4-1">The authorization server issues an access token that is valid for the Customers protected resource (<code>https://api.example.com/customers</code>).<a href="#section-3.2.5.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.5.1.4-2">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "ACCESS_TOKEN",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "customers:read",
  "resource": "https://api.example.com/customers"
}
</pre><a href="#section-3.2.5.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ex-single-resource-refresh">
<section id="section-3.2.5.2">
            <h5 id="name-refresh-token-request-examp">
<a href="#section-3.2.5.2" class="section-number selfRef">3.2.5.2. </a><a href="#name-refresh-token-request-examp" class="section-name selfRef">Refresh Token Request Example</a>
            </h5>
<p id="section-3.2.5.2-1">Client refreshes an access token for the Customers protected resource (<code>https://api.example.com/customers</code>).<a href="#section-3.2.5.2-1" class="pilcrow">¶</a></p>
<div id="refresh-token-request">
<section id="section-3.2.5.2.1">
              <h6 id="name-refresh-token-request">
<a href="#section-3.2.5.2.1" class="section-number selfRef">3.2.5.2.1. </a><a href="#name-refresh-token-request" class="section-name selfRef">Refresh Token Request</a>
              </h6>
<p id="section-3.2.5.2.1-1">The client uses a refresh token to request a new access token that is valid for the Customers protected resource (<code>https://api.example.com/customers</code>).<a href="#section-3.2.5.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.5.2.1-2">
<pre>
POST /token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;
refresh_token=REFRESH_TOKEN&amp;
client_id=client123&amp;
scope=customers%3Aread&amp;
resource=https%3A%2F%2Fapi.example.com%2Fcustomers
</pre><a href="#section-3.2.5.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-response-1">
<section id="section-3.2.5.2.2">
              <h6 id="name-token-response-2">
<a href="#section-3.2.5.2.2" class="section-number selfRef">3.2.5.2.2. </a><a href="#name-token-response-2" class="section-name selfRef">Token Response</a>
              </h6>
<p id="section-3.2.5.2.2-1">The authorization server issues a new access token that is valid for the Customers protected resource (<code>https://api.example.com/customers</code>).<a href="#section-3.2.5.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.5.2.2-2">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "ACCESS_TOKEN",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "customers:read",
  "resource": "https://api.example.com/customers"
}
</pre><a href="#section-3.2.5.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="client-requested-multiple-resources">
<section id="section-3.2.6">
          <h4 id="name-client-requested-multiple-r">
<a href="#section-3.2.6" class="section-number selfRef">3.2.6. </a><a href="#name-client-requested-multiple-r" class="section-name selfRef">Client Requested Multiple Resources</a>
          </h4>
<p id="section-3.2.6-1">If the client included more than one <code>resource</code> parameter in the token request:<a href="#section-3.2.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.6-2.1">
              <p id="section-3.2.6-2.1.1">The response <span class="bcp14">MUST</span> include a <code>resource</code> parameter.<a href="#section-3.2.6-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.6-2.2">
              <p id="section-3.2.6-2.2.1">The value <span class="bcp14">MUST</span> be an array.<a href="#section-3.2.6-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.6-2.3">
              <p id="section-3.2.6-2.3.1">Each returned resource identifier <span class="bcp14">MUST</span> match one requested resource.<a href="#section-3.2.6-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.6-2.4">
              <p id="section-3.2.6-2.4.1">The returned set <span class="bcp14">MAY</span> be a strict subset of the requested set.<a href="#section-3.2.6-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.6-2.5">
              <p id="section-3.2.6-2.5.1">If any unrequested or duplicate resource identifier is present, validation fails.<a href="#section-3.2.6-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="ex-multi-resource-authz">
<section id="section-3.2.6.1">
            <h5 id="name-authorization-request-exampl">
<a href="#section-3.2.6.1" class="section-number selfRef">3.2.6.1. </a><a href="#name-authorization-request-exampl" class="section-name selfRef">Authorization Request Example</a>
            </h5>
<p id="section-3.2.6.1-1">Client obtains an access token for the Customers (<code>https://api.example.com/customers</code>) and Orders (<code>https://api.example.com/orders</code>) protected resources.<a href="#section-3.2.6.1-1" class="pilcrow">¶</a></p>
<div id="authorization-request-1">
<section id="section-3.2.6.1.1">
              <h6 id="name-authorization-request-2">
<a href="#section-3.2.6.1.1" class="section-number selfRef">3.2.6.1.1. </a><a href="#name-authorization-request-2" class="section-name selfRef">Authorization Request</a>
              </h6>
<p id="section-3.2.6.1.1-1">Client makes an authorization request for both protected resources.<a href="#section-3.2.6.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.6.1.1-2">
<pre>
GET /authorize?response_type=code
  &amp;client_id=client123
  &amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
  &amp;scope=customers%3Aread%20orders%3Aread
  &amp;state=abc123
  &amp;resource=https%3A%2F%2Fapi.example.com%2Fcustomers
  &amp;resource=https%3A%2F%2Fapi.example.com%2Forders
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
HTTP/1.1
Host: authorization-server.example.com
</pre><a href="#section-3.2.6.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="redirect-1">
<section id="section-3.2.6.1.2">
              <h6 id="name-redirect-2">
<a href="#section-3.2.6.1.2" class="section-number selfRef">3.2.6.1.2. </a><a href="#name-redirect-2" class="section-name selfRef">Redirect</a>
              </h6>
<p id="section-3.2.6.1.2-1">The authorization server redirects the user-agent back to the client with an authorization code.<a href="#section-3.2.6.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.6.1.2-2">
<pre>
HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA&amp;state=abc123
</pre><a href="#section-3.2.6.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-request-1">
<section id="section-3.2.6.1.3">
              <h6 id="name-token-request-2">
<a href="#section-3.2.6.1.3" class="section-number selfRef">3.2.6.1.3. </a><a href="#name-token-request-2" class="section-name selfRef">Token Request</a>
              </h6>
<p id="section-3.2.6.1.3-1">The client exchanges the authorization code for an access token.<a href="#section-3.2.6.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.6.1.3-2">
<pre>
POST /token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=SplxlOBeZQQYbYS6WxSbIA&amp;
redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb&amp;
client_id=client123&amp;
code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
</pre><a href="#section-3.2.6.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-response-2">
<section id="section-3.2.6.1.4">
              <h6 id="name-token-response-3">
<a href="#section-3.2.6.1.4" class="section-number selfRef">3.2.6.1.4. </a><a href="#name-token-response-3" class="section-name selfRef">Token Response</a>
              </h6>
<p id="section-3.2.6.1.4-1">The authorization server issues an access token that is valid for both protected resources.<a href="#section-3.2.6.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.6.1.4-2">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "ACCESS_TOKEN",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "customers:read orders:read",
  "resource": [
    "https://api.example.com/customers",
    "https://api.example.com/orders"
  ]
}
</pre><a href="#section-3.2.6.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ex-multi-resource-refresh">
<section id="section-3.2.6.2">
            <h5 id="name-refresh-token-request-exampl">
<a href="#section-3.2.6.2" class="section-number selfRef">3.2.6.2. </a><a href="#name-refresh-token-request-exampl" class="section-name selfRef">Refresh Token Request Example</a>
            </h5>
<p id="section-3.2.6.2-1">Client refreshes an access token for the Customers and Orders protected resources.<a href="#section-3.2.6.2-1" class="pilcrow">¶</a></p>
<div id="refresh-token-request-1">
<section id="section-3.2.6.2.1">
              <h6 id="name-refresh-token-request-2">
<a href="#section-3.2.6.2.1" class="section-number selfRef">3.2.6.2.1. </a><a href="#name-refresh-token-request-2" class="section-name selfRef">Refresh Token Request</a>
              </h6>
<p id="section-3.2.6.2.1-1">The client uses a refresh token to request a new access token that is valid for both protected resources.<a href="#section-3.2.6.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.6.2.1-2">
<pre>
POST /token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;
refresh_token=REFRESH_TOKEN&amp;
client_id=client123&amp;
scope=customers%3Aread%20orders%3Aread&amp;
resource=https%3A%2F%2Fapi.example.com%2Fcustomers&amp;
resource=https%3A%2F%2Fapi.example.com%2Forders
</pre><a href="#section-3.2.6.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-response-3">
<section id="section-3.2.6.2.2">
              <h6 id="name-token-response-4">
<a href="#section-3.2.6.2.2" class="section-number selfRef">3.2.6.2.2. </a><a href="#name-token-response-4" class="section-name selfRef">Token Response</a>
              </h6>
<p id="section-3.2.6.2.2-1">The authorization server issues a new access token that is valid for both protected resources.<a href="#section-3.2.6.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.6.2.2-2">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "ACCESS_TOKEN",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "customers:read orders:read",
  "resource": [
    "https://api.example.com/customers",
    "https://api.example.com/orders"
  ]
}
</pre><a href="#section-3.2.6.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="client-did-not-request-a-resource-1">
<section id="section-3.2.7">
          <h4 id="name-client-did-not-request-a-res">
<a href="#section-3.2.7" class="section-number selfRef">3.2.7. </a><a href="#name-client-did-not-request-a-res" class="section-name selfRef">Client Did Not Request a Resource</a>
          </h4>
<p id="section-3.2.7-1">If the client did not include any <code>resource</code> parameters in the token request:<a href="#section-3.2.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.7-2.1">
              <p id="section-3.2.7-2.1.1">If the response includes a <code>resource</code> parameter, the client <span class="bcp14">MAY</span> treat it as a default resource assignment.<a href="#section-3.2.7-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.7-2.2">
              <p id="section-3.2.7-2.2.1">If the response omits the <code>resource</code> parameter, the token <span class="bcp14">SHOULD</span> be treated as unbounded.<a href="#section-3.2.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="ex-default-resource-authz">
<section id="section-3.2.7.1">
            <h5 id="name-authorization-request-example">
<a href="#section-3.2.7.1" class="section-number selfRef">3.2.7.1. </a><a href="#name-authorization-request-example" class="section-name selfRef">Authorization Request Example</a>
            </h5>
<p id="section-3.2.7.1-1">Client obtains an access token without requesting a specific resource.<a href="#section-3.2.7.1-1" class="pilcrow">¶</a></p>
<div id="authorization-request-2">
<section id="section-3.2.7.1.1">
              <h6 id="name-authorization-request-3">
<a href="#section-3.2.7.1.1" class="section-number selfRef">3.2.7.1.1. </a><a href="#name-authorization-request-3" class="section-name selfRef">Authorization Request</a>
              </h6>
<p id="section-3.2.7.1.1-1">Client makes an authorization request without including a resource indicator.<a href="#section-3.2.7.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.7.1.1-2">
<pre>
GET /authorize?response_type=code
  &amp;client_id=client123
  &amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
  &amp;scope=orders%3Aread
  &amp;state=abc123
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
HTTP/1.1
Host: authorization-server.example.com
</pre><a href="#section-3.2.7.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="redirect-2">
<section id="section-3.2.7.1.2">
              <h6 id="name-redirect-3">
<a href="#section-3.2.7.1.2" class="section-number selfRef">3.2.7.1.2. </a><a href="#name-redirect-3" class="section-name selfRef">Redirect</a>
              </h6>
<p id="section-3.2.7.1.2-1">The authorization server redirects the user-agent back to the client with an authorization code.<a href="#section-3.2.7.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.7.1.2-2">
<pre>
HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA&amp;state=abc123
</pre><a href="#section-3.2.7.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-request-2">
<section id="section-3.2.7.1.3">
              <h6 id="name-token-request-3">
<a href="#section-3.2.7.1.3" class="section-number selfRef">3.2.7.1.3. </a><a href="#name-token-request-3" class="section-name selfRef">Token Request</a>
              </h6>
<p id="section-3.2.7.1.3-1">The client exchanges the authorization code for an access token.<a href="#section-3.2.7.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.7.1.3-2">
<pre>
POST /token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=SplxlOBeZQQYbYS6WxSbIA&amp;
redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb&amp;
client_id=client123&amp;
code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
</pre><a href="#section-3.2.7.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-response-4">
<section id="section-3.2.7.1.4">
              <h6 id="name-token-response-5">
<a href="#section-3.2.7.1.4" class="section-number selfRef">3.2.7.1.4. </a><a href="#name-token-response-5" class="section-name selfRef">Token Response</a>
              </h6>
<p id="section-3.2.7.1.4-1">The authorization server issues an access token that is valid for the default protected resource (<code>https://api.example.com/orders</code>).<a href="#section-3.2.7.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.7.1.4-2">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "ACCESS_TOKEN",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "orders:read",
  "resource": "https://api.example.com/orders"
}
</pre><a href="#section-3.2.7.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ex-default-resource-refresh">
<section id="section-3.2.7.2">
            <h5 id="name-refresh-token-request-example">
<a href="#section-3.2.7.2" class="section-number selfRef">3.2.7.2. </a><a href="#name-refresh-token-request-example" class="section-name selfRef">Refresh Token Request Example</a>
            </h5>
<p id="section-3.2.7.2-1">Client refreshes an access token without explicitly requesting a resource.<a href="#section-3.2.7.2-1" class="pilcrow">¶</a></p>
<div id="refresh-token-request-2">
<section id="section-3.2.7.2.1">
              <h6 id="name-refresh-token-request-3">
<a href="#section-3.2.7.2.1" class="section-number selfRef">3.2.7.2.1. </a><a href="#name-refresh-token-request-3" class="section-name selfRef">Refresh Token Request</a>
              </h6>
<p id="section-3.2.7.2.1-1">The client uses a refresh token to request a new access token without explicitly requesting a resource.<a href="#section-3.2.7.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.7.2.1-2">
<pre>
POST /token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;
refresh_token=REFRESH_TOKEN&amp;
client_id=client123&amp;
scope=orders%3Aread
</pre><a href="#section-3.2.7.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="token-response-5">
<section id="section-3.2.7.2.2">
              <h6 id="name-token-response-6">
<a href="#section-3.2.7.2.2" class="section-number selfRef">3.2.7.2.2. </a><a href="#name-token-response-6" class="section-name selfRef">Token Response</a>
              </h6>
<p id="section-3.2.7.2.2-1">The authorization server issues a new access token that is valid for the default protected resource (<code>https://api.example.com/orders</code>).<a href="#section-3.2.7.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.7.2.2-2">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "ACCESS_TOKEN",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "orders:read",
  "resource": "https://api.example.com/orders"
}
</pre><a href="#section-3.2.7.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="invalid-resource">
<section id="section-3.2.8">
          <h4 id="name-invalid-resource">
<a href="#section-3.2.8" class="section-number selfRef">3.2.8. </a><a href="#name-invalid-resource" class="section-name selfRef">Invalid Resource</a>
          </h4>
<p id="section-3.2.8-1">An <code>invalid_target</code> error indicates that none of the requested resource values were acceptable to the authorization server. This outcome may result from authorization server policy or client configuration.<a href="#section-3.2.8-1" class="pilcrow">¶</a></p>
<p id="section-3.2.8-2">Upon receiving an <code>invalid_target</code> error, the client <span class="bcp14">MAY</span> retry the authorization request with a different <code>resource</code> value.<a href="#section-3.2.8-2" class="pilcrow">¶</a></p>
<div id="ex-invalid-resource-authz">
<section id="section-3.2.8.1">
            <h5 id="name-authorization-request-example-2">
<a href="#section-3.2.8.1" class="section-number selfRef">3.2.8.1. </a><a href="#name-authorization-request-example-2" class="section-name selfRef">Authorization Request Example</a>
            </h5>
<p id="section-3.2.8.1-1">Client attempts to obtain an access token for a protected resource (<code>https://unknown.example.com</code>) that is not permitted.<a href="#section-3.2.8.1-1" class="pilcrow">¶</a></p>
<div id="authorization-request-3">
<section id="section-3.2.8.1.1">
              <h6 id="name-authorization-request-4">
<a href="#section-3.2.8.1.1" class="section-number selfRef">3.2.8.1.1. </a><a href="#name-authorization-request-4" class="section-name selfRef">Authorization Request</a>
              </h6>
<p id="section-3.2.8.1.1-1">Client makes an authorization request for a protected resource that is not permitted.<a href="#section-3.2.8.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.8.1.1-2">
<pre>
GET /authorize?response_type=code
  &amp;client_id=client123
  &amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
  &amp;scope=customers%3Aread
  &amp;state=invalid123
  &amp;resource=https%3A%2F%2Fevil.example.net%2F
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
HTTP/1.1
Host: authorization-server.example.com
</pre><a href="#section-3.2.8.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-redirect">
<section id="section-3.2.8.1.2">
              <h6 id="name-error-redirect">
<a href="#section-3.2.8.1.2" class="section-number selfRef">3.2.8.1.2. </a><a href="#name-error-redirect" class="section-name selfRef">Error Redirect</a>
              </h6>
<p id="section-3.2.8.1.2-1">The authorization server rejects the requested resource and does not issue an authorization code.<a href="#section-3.2.8.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.8.1.2-2">
<pre>
HTTP/1.1 302 Found
Location: https://client.example.com/cb?error=invalid_target&amp;error_description=Resource%20not%20allowed&amp;state=invalid123
</pre><a href="#section-3.2.8.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ex-invalid-resource-refresh">
<section id="section-3.2.8.2">
            <h5 id="name-refresh-token-request-example-2">
<a href="#section-3.2.8.2" class="section-number selfRef">3.2.8.2. </a><a href="#name-refresh-token-request-example-2" class="section-name selfRef">Refresh Token Request Example</a>
            </h5>
<p id="section-3.2.8.2-1">Client attempts to refresh an access token for a protected resource (<code>https://unknown.example.com</code>) that is not permitted.<a href="#section-3.2.8.2-1" class="pilcrow">¶</a></p>
<div id="refresh-token-request-3">
<section id="section-3.2.8.2.1">
              <h6 id="name-refresh-token-request-4">
<a href="#section-3.2.8.2.1" class="section-number selfRef">3.2.8.2.1. </a><a href="#name-refresh-token-request-4" class="section-name selfRef">Refresh Token Request</a>
              </h6>
<p id="section-3.2.8.2.1-1">The client uses a refresh token to request a new access token for a protected resource that is not permitted.<a href="#section-3.2.8.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.8.2.1-2">
<pre>
POST /token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;
refresh_token=REFRESH_TOKEN&amp;
client_id=client123&amp;
scope=customers%3Aread&amp;
resource=https%3A%2F%2Fevil.example.net%2F
</pre><a href="#section-3.2.8.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-response">
<section id="section-3.2.8.2.2">
              <h6 id="name-error-response">
<a href="#section-3.2.8.2.2" class="section-number selfRef">3.2.8.2.2. </a><a href="#name-error-response" class="section-name selfRef">Error Response</a>
              </h6>
<p id="section-3.2.8.2.2-1">The authorization server rejects the requested resource.<a href="#section-3.2.8.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.8.2.2-2">
<pre>
HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error": "invalid_target",
  "error_description": "Resource not allowed"
}
</pre><a href="#section-3.2.8.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">The lack of confirmation about which resource(s) an authorization server has selected for an access token introduces a security risk in OAuth deployments, particularly when:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">A client uses multiple authorization servers and resource servers.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">A client dynamically discovers an authorization server and attempts to obtain an access token at runtime via an HTTP authorization challenge with OAuth 2.0 Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">An attacker attempts a <strong>mix-up attack</strong> where a token intended for one resource is used at another.<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.4">
          <p id="section-4-2.4.1">The authorization server ignores or overrides the requested resource without informing the client.<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">This specification addresses such issues by explicitly returning the resource(s) for which the access token is intended in the token response.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">A malicious protected resource may intercept an access token during a client's legitimate request and subsequently reuse that token to access other resources that trust the same authorization server and accept tokens with the same audience and scopes. This attack is particularly relevant when the client cannot fully validate the trust relationship between the protected resource and the authorization server, such as in dynamic discovery scenarios using <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">To prevent token reuse attacks by malicious protected resources, access tokens <span class="bcp14">SHOULD</span> require proof-of-possession, such as DPoP (Demonstrating Proof-of-Possession) as defined in <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>. By binding the access token to a cryptographic key held by the client and requiring demonstration of key possession when using the token, proof-of-possession mechanisms prevent a malicious protected resource that intercepts the access token from reusing it at other resources, since it does not possess the client's private key. Both the client and authorization server must support proof-of-possession mechanisms for this protection to be effective. See <span><a href="https://rfc-editor.org/rfc/rfc9449#section-9" class="relref">Section 9</a> of [<a href="#RFC9449" class="cite xref">RFC9449</a>]</span> for details on how DPoP provides proof-of-possession.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">Validating the <code>resource</code> parameter in the token response provides defense-in-depth for the client. While it helps the client detect when an authorization server has issued a token for a different resource than requested, it does not prevent a malicious protected resource from reusing an intercepted token at other resources. Clients are advised to validate the <code>resource</code> parameter as specified in <span><a href="#client-processing-rules" class="internal xref">Client Processing Rules</a> (<a href="#client-processing-rules" class="auto internal xref">Section 3.2</a>)</span> and treat mismatches as errors unless explicitly designed to handle token audience negotiation. Clients that require strict resource binding <span class="bcp14">SHOULD</span> treat the absence of the <code>resource</code> parameter as a potential ambiguity.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-5">
      <h2 id="name-privacy-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-5-1">Returning the <code>resource</code> value may reveal some information about the protected resource. If the value is sensitive, the authorization server <span class="bcp14">SHOULD</span> assess whether the resource name can be safely disclosed to the client.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document registers the following value in the OAuth Parameters registry established by <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="oauth-access-token-response-parameters-registry">
<section id="section-6.1">
        <h3 id="name-oauth-access-token-response">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-oauth-access-token-response" class="section-name selfRef">OAuth Access Token Response Parameters Registry</a>
        </h3>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">resource</td>
              <td class="text-left" rowspan="1" colspan="1">Resource to which the access token applies</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="sec-normative-references">
<section id="section-7">
      <h2 id="name-normative-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8707">[RFC8707]</dt>
      <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Resource Indicators for OAuth 2.0"</span>, <span class="seriesInfo">RFC 8707</span>, <span class="seriesInfo">DOI 10.17487/RFC8707</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8707">https://www.rfc-editor.org/info/rfc8707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9728">[RFC9728]</dt>
      <dd>
<span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">Hunt, P.</span>, and <span class="refAuthor">A. Parecki</span>, <span class="refTitle">"OAuth 2.0 Protected Resource Metadata"</span>, <span class="seriesInfo">RFC 9728</span>, <span class="seriesInfo">DOI 10.17487/RFC9728</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9728">https://www.rfc-editor.org/info/rfc9728</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9207">[RFC9207]</dt>
      <dd>
<span class="refAuthor">Meyer zu Selhausen, K.</span> and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Issuer Identification"</span>, <span class="seriesInfo">RFC 9207</span>, <span class="seriesInfo">DOI 10.17487/RFC9207</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9207">https://www.rfc-editor.org/info/rfc9207</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7662">[RFC7662]</dt>
      <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9700">[RFC9700]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"Best Current Practice for OAuth 2.0 Security"</span>, <span class="seriesInfo">BCP 240</span>, <span class="seriesInfo">RFC 9700</span>, <span class="seriesInfo">DOI 10.17487/RFC9700</span>, <time datetime="2025-01" class="refDate">January 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9700">https://www.rfc-editor.org/info/rfc9700</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9449">[RFC9449]</dt>
      <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9449">https://www.rfc-editor.org/info/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="additional-examples">
<section id="appendix-A">
      <h2 id="name-additional-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-additional-examples" class="section-name selfRef">Additional Examples</a>
      </h2>
<div id="requesting-a-token-for-a-dynamically-discovered-protected-resource">
<section id="appendix-A.1">
        <h3 id="name-requesting-a-token-for-a-dy">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-requesting-a-token-for-a-dy" class="section-name selfRef">Requesting a token for a dynamically discovered protected resource</a>
        </h3>
<p id="appendix-A.1-1">The following example details the need for the <code>resource</code> parameter when a client dynamically discovers an authorization server and obtains an access token using <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> and <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span><a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Client attempts to access a protected a resource without a valid access token<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-3">
<pre>
GET /resource
Host: api.example.com
Accept: application/json
</pre><a href="#appendix-A.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-4">Client is challenged for authentication<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-5">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer resource_metadata=
  "https://api.example.com/.well-known/oauth-protected-resource"
</pre><a href="#appendix-A.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-6">Client fetches the resource's OAuth 2.0 Protected Resource Metadata per <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> to dynamically discover an authorization server that can issue an access token for the resource.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-7">
<pre>
GET /.well-known/oauth-protected-resource
Host: api.example.com
Accept: application/json

HTTP/1.1 200 Ok
Content-Type: application/json

{
   "resource":
     "https://api.example.com/resource",
   "authorization_servers":
     [ "https://authorization-server.example.com/" ],
   "bearer_methods_supported":
     ["header", "body"],
   "scopes_supported":
     ["resource.read", "resource.write"],
   "resource_documentation":
     "https://api.example.com/resource_documentation.html"
 }
</pre><a href="#appendix-A.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-8">Client discovers the Authorization Server configuration per <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span><a href="#appendix-A.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-9">
<pre>
GET /.well-known/oauth-authorization-server
Host: authorization-server.example.com
Accept: application/json

HTTP/1.1 200 Ok
Content-Type: application/json

{
  "issuer": "https://authorization-server.example.com/",
  "authorization_endpoint": "https://authorization-server.example.com/oauth2/authorize",
  "token_endpoint": "https://authorization-server.example.com/oauth2/token",
  "jwks_uri": "https://authorization-server.example.com/oauth2/keys",
  "scopes_supported": [
    "resource.read", "resource.write"
  ],
  "response_types_supported": [
    "code"
  ],
  "grant_types_supported": [
    "authorization_code", "refresh_token"
  ],
  ...
}
</pre><a href="#appendix-A.1-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-10">Client makes an authorization request for the resource<a href="#appendix-A.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-11">
<pre>
GET /oauth2/authorize?response_type=code
  &amp;client_id=client123
  &amp;redirect_uri=https%3A%2F%2Fclient.example%2Fcallback
  &amp;scope=resource%3Aread
  &amp;state=abc123
  &amp;resource=https%3A%2F%2Fapi.example.com%2Fresource
  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &amp;code_challenge_method=S256
HTTP/1.1
Host: authorization-server.example.com
</pre><a href="#appendix-A.1-11" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-12">User successfully authenticates and delegates access to the client for the requested resource and scopes<a href="#appendix-A.1-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-13">
<pre>
HTTP/1.1 302 Found
Location: https://client.example/callback?code=SplxlOBeZQQYbYS6WxSbIA&amp;state=abc123
</pre><a href="#appendix-A.1-13" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-14">Client exchanges the authorization code for an access token<a href="#appendix-A.1-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-15">
<pre>
POST /oauth2/token HTTP/1.1
Host: authorization-server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=SplxlOBeZQQYbYS6WxSbIA&amp;
redirect_uri=https%3A%2F%2Fclient.example%2Fcallback&amp;
client_id=client123&amp;
code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
</pre><a href="#appendix-A.1-15" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-16">Client obtains an access token for the resource.<a href="#appendix-A.1-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-17">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "resource:read",
  "resource": "https://api.example.com/resource"
}
</pre><a href="#appendix-A.1-17" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-18">Client verifies that it obtained an access token explicitly bound to the discovered resource.<a href="#appendix-A.1-18" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This proposal builds on prior work in OAuth 2.0 extensibility and security analysis, particularly <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>, <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, and <span>[<a href="#RFC9207" class="cite xref">RFC9207</a>]</span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">-01<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">Revised Introduction and included attack example<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1">Provided context for use of Resource vs Audience<a href="#appendix-C-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1">Revised Response to clarify Authorization Server and Client Processing Rules<a href="#appendix-C-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1">Updated Security Considerations<a href="#appendix-C-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.5">
          <p id="appendix-C-2.5.1">Document cleanup and consistency<a href="#appendix-C-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-3">-00<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">Initial revision<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Karl McGuinness</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:public@karlmcguinness.com" class="email">public@karlmcguinness.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jared Hanson</span></div>
<div dir="auto" class="left"><span class="org">Keycard Labs</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jared@keycard.ai" class="email">jared@keycard.ai</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://keycard.ai" class="url">https://keycard.ai</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
